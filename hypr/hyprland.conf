source = ~/.cache/wal/hyprland.conf

# Monitor
monitor=,highres@highrr,auto,auto

# Programs
$terminal = kitty
$browser = qutebrowser
$scripts = ~/.config/scripts
$rofiscripts = ~/.config/rofi/scripts

# Autostart
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY
exec-once = systemctl --user start hyprpolkitagent
exec-once = playerctld daemon
exec-once = udiskie --smart-tray --no-automount
exec-once = swww-daemon
exec-once = $scripts/randomize_background.fish ~/pictures/backgrounds
exec-once = wired
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = hyprsunset
exec-once = hypridle
exec-once = waybar
exec-once = rqbit --enable-upnp-server --http-api-listen-addr "0.0.0.0:3030" server start ~/downloads

# Environment variables

## Terminal
env = TERMINAL,kitty
env = TERMCMD,kitty
env = VISUAL,nvim
env = EDITOR,nvim
env = BROWSER,$browser
env = MANPAGER,nvim +Man!

## Cursor
env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24

## NVidia
env = GDK_BACKEND,wayland,x11
env = GBM_BACKEND,nvidia-drm
env = LIBVA_DRIVER_NAME,nvidia
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland
env = MOZ_ENABLE_WAYLAND,1
env = MOZ_DISABLE_RDD_SANDBOX,1
env = _JAVA_AWT_WM_NONREPARENTING,1
env = QT_AUTO_SCREEN_SCALE_FACTOR,1
env = QT_QPA_PLATFORM,wayland
env = WLR_NO_HARDWARE_CURSORS,1
env = __NV_PRIME_RENDER_OFFLOAD,1
env = __VK_LAYER_NV_optimus,NVIDIA_only
env = PROTON_ENABLE_NGX_UPDATER,1
env = NVD_BACKEND,direct
env = __GL_GSYNC_ALLOWED,1
env = __GL_VRR_ALLOWED,1
env = WLR_DRM_NO_ATOMIC,1
env = WLR_USE_LIBINPUT,1
# env = XWAYLAND_NO_GLAMOR,1 # with this you'll need to use gamescope for gaming
env = __GL_MaxFramesAllowed,1
env = WLR_RENDERER_ALLOW_SOFTWARE,1

## Electron
env = ELECTRON_OZONE_PLATFORM_HINT,auto

## Qt
env = QT_QPA_PLATFORMTHEME,qt6ct

# Permissions
# See https://wiki.hypr.land/Configuring/Permissions/
# ecosystem {
#   enforce_permissions = 1
# }

# permission = /usr/(bin|local/bin)/grim, screencopy, allow
# permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-hyprland, screencopy, allow
# permission = /usr/(bin|local/bin)/hyprpm, plugin, allow


# Look & feel
general {
    layout = dwindle

    gaps_in = 4
    gaps_out = 8
    border_size = 3

    col.active_border = $color15 $color14 45deg
    col.inactive_border = $color2
    col.nogroup_border = $color9
    col.nogroup_border_active = $color12

    allow_tearing = true
    resize_on_border = true
}

decoration {
    rounding = 0
    rounding_power = 0

    active_opacity = 0.85
    inactive_opacity = 0.85

    shadow {
        enabled = true
        range = 8
        render_power = 3
        color = $shadow
    }

    blur {
        enabled = true
        ignore_opacity = true
        # xray = true
        popups = true
        size = 7
        passes = 4
    }
}

animations {
    enabled = yes, please :)

    bezier = linear, 0.0, 0.0, 1, 1
    bezier = easeInQuint, 0.64, 0, 0.78, 0
    bezier = easeOutQuint, 0.22, 1, 0.36, 1
    bezier = easeInCubic, 0.32, 0, 0.67, 0
    bezier = easeOutCubic, 0.33, 1, 0.68, 1

    animation = border, 1, 0.5, linear
    animation = borderangle, 0, 0.5, linear, once
    animation = workspaces, 0
    animation = windows, 1, 1, linear
    animation = windowsIn, 1, 3.5, easeOutQuint, popin 87%
    animation = windowsOut, 1, 5, easeOutCubic, popin 87%
    animation = windowsMove, 1, 1.5, easeOutQuint
    animation = layersIn, 1, 1.5, easeOutQuint, popin 87%
    animation = layersOut, 1, 5, easeOutCubic, popin 87%
    animation = fade, 0
    animation = fadeIn, 1, 1, linear
    animation = fadeOut, 1, 1.5, easeOutQuint
    animation = fadeLayersIn, 1, 1, linear
    animation = fadeLayersOut, 1, 1.5, easeOutQuint
}

dwindle {
    pseudotile = true
    preserve_split = true
}

misc {
    font_family = Iosevka Nerd Font Propo
    splash_font_family = Iosevka Nerd Font Propo
    disable_hyprland_logo = true
    disable_splash_rendering = true
    force_default_wallpaper = 0
    focus_on_activate = false
}

input {
    kb_layout = us,il
    kb_options = grp:win_space_toggle

    repeat_rate = 50
    repeat_delay = 300
    follow_mouse = 2
    sensitivity = 0

    touchpad {
        natural_scroll = false
    }
}

xwayland {
    force_zero_scaling = true
}

# debug {
#     disable_logs = false
#     enable_stdout_logs = true
# }

# Keybindings
$mod = SUPER
$hypr = SUPER ALT CTRL SHIFT

# Move focus
bind = $mod, H, movefocus, l
bind = $mod, J, movefocus, d
bind = $mod, K, movefocus, u
bind = $mod, L, movefocus, r
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d

# Move focused window
bind = $mod SHIFT, H, movewindow, l
bind = $mod SHIFT, J, movewindow, d
bind = $mod SHIFT, K, movewindow, u
bind = $mod SHIFT, L, movewindow, r
bind = $mod SHIFT, left, movewindow, l
bind = $mod SHIFT, right, movewindow, r
bind = $mod SHIFT, up, movewindow, u
bind = $mod SHIFT, down, movewindow, d
bindm = $mod, mouse:272, movewindow

# Resize focused window
binde  = $mod ALT, H, resizeactive, -5% 0
binde  = $mod ALT, J, resizeactive, 0 -5%
binde  = $mod ALT, K, resizeactive, 0 5%
binde  = $mod ALT, L, resizeactive, 5% 0
binde  = $mod ALT, left, resizeactive, -5% 0
binde  = $mod ALT, right, resizeactive, 5% 0
binde  = $mod ALT, up, resizeactive, 0 5%
binde  = $mod ALT, down, resizeactive, 0 -5%
bindm = $mod, mouse:273, resizewindow

# Move focused window
bind = $mod ALT SHIFT, H, swapwindow, l
bind = $mod ALT SHIFT, J, swapwindow, d
bind = $mod ALT SHIFT, K, swapwindow, u
bind = $mod ALT SHIFT, L, swapwindow, r
bind = $mod ALT SHIFT, left, swapwindow, l
bind = $mod ALT SHIFT, right, swapwindow, r
bind = $mod ALT SHIFT, up, swapwindow, u
bind = $mod ALT SHIFT, down, swapwindow, d

# Fullscreen
bind = $mod, M, fullscreen, 1
bind = $mod SHIFT, M, fullscreen, 0

bind = $mod, slash, exec, rofi -modi drun,run -show drun -show-icons
bind = $mod, Tab, exec, rofi -modi window -show window -show-icons -display-drun 'Windows' -show-icons
bind = $mod SHIFT, escape, exec, rofi -show power-menu:'$rofiscripts/rofi-power-menu.sh --choices=shutdown/reboot/lockscreen/logout' -theme-str 'window {width: 5%; height: 20%;}'
bind = $mod, C, exec, rofi -modi clipboard:$rofiscripts/rofi-clip.sh -show clipboard -show-icons -display-column 2
bind = $mod CTRL, C, exec, rofi -show calc -modi calc -no-show-match -no-sort
bind = $mod SHIFT, C, exec, hyprpicker --autocopy --format=hex --lowercase-hex
bind = $mod, P, exec, $rofiscripts/rofi-pass.fish
bind = $mod ALT, P, exec, $rofiscripts/rofi-pass.fish show-last
bind = $mod SHIFT, P, exec, $rofiscripts/rofi-pass.fish insert
bind = $mod, E, exec, rofimoji --keybinding-copy alt-c
bind = $mod, B, exec, $rofiscripts/rofi-background.fish ~/pictures/backgrounds
bind = $mod SHIFT, W, exec, $rofiscripts/rofi-rename-workspace.fish

# Switch workspaces with mod + [0-9]
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

# Move active window to a workspace with mod + SHIFT + [0-9]
bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, 5, movetoworkspace, 5
bind = $mod SHIFT, 6, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7
bind = $mod SHIFT, 8, movetoworkspace, 8
bind = $mod SHIFT, 9, movetoworkspace, 9
bind = $mod SHIFT, 0, movetoworkspace, 10

# Scroll through existing workspaces with mod + scroll
bind = $mod, mouse_down, workspace, e+1
bind = $mod, mouse_up, workspace, e-1

# Layout
bind = $mod, V, togglesplit
bind = $mod, F, cyclenext, none, floating
bind = $mod SHIFT, F, focuscurrentorlast
bind = $mod ALT, F, togglefloating

# Media
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioStop, exec, playerctl stop
bindl = , XF86AudioPrev, exec, playerctl previous
bindl = , XF86AudioNext, exec, playerctl next
bindl = CTRL, XF86AudioPrev, exec, playerctld unshift
bindl = CTRL, XF86AudioNext, exec, playerctld shift
bindl = CTRL, XF86AudioPrev, exec, playerctld unshift
bindl = CTRL, XF86AudioNext, exec, playerctld shift
bindel = , XF86AudioRaiseVolume, exec, $scripts/media.fish volume sink up
bindel = , XF86AudioLowerVolume, exec, $scripts/media.fish volume sink down
bindel = , XF86AudioMute, exec, $scripts/media.fish volume sink mute
bindel = SHIFT, XF86AudioRaiseVolume, exec, $scripts/media.fish volume source up
bindel = SHIFT, XF86AudioLowerVolume, exec, $scripts/media.fish volume source down
bindel = SHIFT, XF86AudioMute, exec, $scripts/media.fish volume source mute
bindel = $mod, XF86AudioRaiseVolume, exec, $scripts/media.fish brightness up
bindel = $mod, XF86AudioLowerVolume, exec, $scripts/media.fish brightness down
bindel = $mod, XF86AudioMute, exec, $scripts/media.fish brightness reset
bindel = $mod SHIFT, XF86AudioRaiseVolume, exec, $scripts/media.fish temperature up
bindel = $mod SHIFT, XF86AudioLowerVolume, exec, $scripts/media.fish temperature down
bindel = $mod SHIFT, XF86AudioMute, exec, $scripts/media.fish temperature reset
bindl = , Print, exec, $rofiscripts/rofi-screen.fish
bindl = CTRL, Print, exec, $scripts/screen.fish --action=shot --region=region --to=ui
bindl = ALT, Print, exec, $scripts/screen.fish --action=record --region=region --to=file
# bindel = , XF86MonBrightnessUp, exec, $scripts/media.fish brightness up
# bindel = , XF86MonBrightnessDown, exec, $scripts/media.fish brightness down

# Misc
bind = $mod SHIFT, T, exec, $scripts/set_theme.fish toggle
bind = $mod, N, exec, wired --drop latest
bind = $mod SHIFT, N, exec, wired --drop all
bind = $mod, Q, killactive
bind = $mod, escape, exec, hyprlock
bind = $hypr, escape, exit

# Apps
bind = $mod, O, submap, apps

submap = apps

bind = , T, exec, $terminal
bind = , T, submap, reset

bind = , N, exec, nyxt
bind = , N, submap, reset

bind = , B, exec, $browser
bind = , B, submap, reset

bind = , P, exec, $browser --target private-window -s content.private_browsing True
bind = , P, submap, reset

bind = , D, exec, vesktop
bind = , D, submap, reset

bind = , s, exec, spotify-launcher
bind = , s, submap, reset

bind = , catchall, submap, reset
submap = reset

bind = $mod, comma, submap, settings
submap = settings

bind = , b, exec, bzmenu -l rofi
bind = , b, submap, reset

bind = , s, exec, $rofiscripts/rofi-sound.fish
bind = , s, submap, reset

bind = , w, exec, iwmenu -l rofi
bind = , w, submap, reset

bind = , d, exec, $rofiscripts/rofi-systemd.sh
bind = , d, submap, reset

bind = , u, exec, $rofiscripts/rofi-usb.fish
bind = , u, submap, reset

bind = , k, exec, $rofiscripts/rofi-kill.fish
bind = , k, submap, reset

bind = , catchall, submap, reset
submap = reset

# Windows & Workspaces

## Workspaces
workspace = 1, defaultName:core
workspace = 2, defaultName:vibe

## Ignore maximize requests from apps. You'll probably like this.
windowrule = suppressevent maximize, class:.*

## Fix some dragging issues with XWayland
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

## Games
$native_games = ^(cs2)$
$proton_games = ^steam_app_\d+$
$games = class:$native_games|$proton_games
windowrule = immediate, $games
windowrule = opacity 1 override 1 override, $games
windowrule = noblur, $games
# windowrule = fullscreen, $games
windowrule = workspace 5, $games
workspace = 5, defaultName:gaming, border:false, rounding:false, gamesout:0, gamesin:0

## Make steam's friends list floating
windowrule = float, class:^(steam)$, title:^(Friends List)$

## Layer rules
layerrule = blur, rofi
layerrule = blur, waybar
layerrule = ignorezero, waybar
layerrule = noanim, waybar
layerrule = blur, wired
layerrule = ignorezero, wired
layerrule = noanim, hyprpicker

# ## Disable gaps and border for workspaces with one window
# workspace = w[tv1], gapsout:0, gapsin:0
# workspace = f[1], gapsout:0, gapsin:0
# windowrulev2 = bordersize 0, floating:0, onworkspace:w[tv1]
# windowrulev2 = rounding 0, floating:0, onworkspace:w[tv1]
# windowrulev2 = bordersize 0, floating:0, onworkspace:f[1]
# windowrulev2 = rounding 0, floating:0, onworkspace:f[1]
