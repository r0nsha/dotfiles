# Monitor
monitor=,highres@highrr,auto,auto

# Programs
$terminal = kitty
$browser = qutebrowser
$filemanager = dolphin
$scripts = ~/.config/scripts
$rofiscripts = ~/.config/rofi/scripts

# Autostart
exec-once = systemctl --user start hyprpolkitagent
exec-once = playerctld daemon
exec-once = udiskie --smart-tray --no-automount
exec-once = swww-daemon
exec-once = $scripts/swww_randomize.fish ~/pictures/backgrounds
exec-once = wired
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = hyprsunset
exec-once = hypridle
exec-once = waybar
# TODO: exec_always --no-startup-id rqbit server start ~/downloads

# Environment variables

## Terminal
env = TERMINAL,kitty
env = TERMCMD,kitty
env = VISUAL,nvim
env = EDITOR,nvim
env = BROWSER,qutebrowser
env = MANPAGER,nvim +Man!

## Cursor
env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24

## NVidia
env = LIBVA_DRIVER_NAME,nvidia
env = __GLX_VENDOR_LIBRARY_NAME,nvidia

## Electron
env = ELECTRON_OZONE_PLATFORM_HINT,auto

# Permissions
# See https://wiki.hypr.land/Configuring/Permissions/
# ecosystem {
#   enforce_permissions = 1
# }

# permission = /usr/(bin|local/bin)/grim, screencopy, allow
# permission = /usr/(lib|libexec|lib64)/xdg-desktop-portal-hyprland, screencopy, allow
# permission = /usr/(bin|local/bin)/hyprpm, plugin, allow


# Look & feel
general {
    layout = dwindle

    gaps_in = 4
    gaps_out = 8
    border_size = 2

    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
    col.nogroup_border = rgba(ffffaaff)
    col.nogroup_border_active = rgba(ffff00ff)
    allow_tearing = true

    resize_on_border = true
}

decoration {
    rounding = 0
    rounding_power = 0

    active_opacity = 0.8
    inactive_opacity = 0.8

    shadow {
        enabled = true
        range = 8
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        ignore_opacity = true
        # xray = true
        popups = true
        size = 7
        passes = 4
    }
}

animations {
    enabled = yes, please :)

    bezier = linear, 0.0, 0.0, 1, 1
    bezier = easeInQuint, 0.64, 0, 0.78, 0
    bezier = easeOutQuint, 0.22, 1, 0.36, 1
    bezier = easeInCubic, 0.32, 0, 0.67, 0
    bezier = easeOutCubic, 0.33, 1, 0.68, 1

    animation = border, 1, 0.5, linear
    animation = borderangle, 1, 2, linear, once
    animation = workspaces, 0
    animation = windows, 1, 1, linear
    animation = windowsIn, 1, 3.5, easeOutQuint, popin 87%
    animation = windowsOut, 1, 5, easeOutCubic, popin 87%
    animation = windowsMove, 1, 1.5, easeOutQuint
    animation = layersIn, 1, 1.5, easeOutQuint, popin 87%
    animation = layersOut, 1, 5, easeOutCubic, popin 87%
    animation = fade, 0
    animation = fadeIn, 1, 1, linear
    animation = fadeOut, 1, 1.5, easeOutQuint
    animation = fadeLayersIn, 1, 1, linear
    animation = fadeLayersOut, 1, 1.5, easeOutQuint
}

dwindle {
    pseudotile = true
    preserve_split = true
}

misc {
    font_family = Iosevka Nerd Font Propo
    splash_font_family = Iosevka Nerd Font Propo
    disable_hyprland_logo = true
    disable_splash_rendering = true
    force_default_wallpaper = 0
    focus_on_activate = true
}

input {
    kb_layout = us,il
    kb_options = grp:win_space_toggle

    repeat_rate = 50
    repeat_delay = 300
    follow_mouse = 2
    sensitivity = 0

    touchpad {
        natural_scroll = false
    }
}

gestures {
    workspace_swipe = false
}

xwayland {
    force_zero_scaling = true
}

# debug {
#     disable_logs = false
#     enable_stdout_logs = true
# }

plugin {
    hyprfocus {
        enabled = yes
        animate_floating = no
        animate_workspacechange = no
        focus_animation = shrink

        bezier = bezIn, 0.5, 0.0, 1.0, 0.5
        bezier = bezOut, 0.0, 0.5, 0.5, 1.0
        bezier = overshot, 0.05, 0.9, 0.1, 1.05
        bezier = smoothOut, 0.36, 0, 0.66, -0.56
        bezier = smoothIn, 0.25, 1, 0.5, 1
        bezier = realsmooth, 0.28, 0.29, 0.69, 1.08
        bezier = easeInOutBack, 0.68, -0.6, 0.32, 1.6

        flash {
            flash_opacity = 1.0
            in_bezier = bezIn
            in_speed = 0.5
            out_bezier = bezOut
            out_speed = 3
        }

        shrink {
            shrink_percentage = 0.99
            in_bezier = easeInOutBack
            in_speed = 1.5
            out_bezier = easeInOutBack
            out_speed = 3
        }
    }
}
# Keybindings
$mod = SUPER
$hypr = SUPER ALT CTRL SHIFT

# Move focus
bind = $mod, H, movefocus, l
bind = $mod, J, movefocus, d
bind = $mod, K, movefocus, u
bind = $mod, L, movefocus, r
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d

# Move focused window
bind = $mod SHIFT, H, movewindow, l
bind = $mod SHIFT, J, movewindow, d
bind = $mod SHIFT, K, movewindow, u
bind = $mod SHIFT, L, movewindow, r
bind = $mod SHIFT, left, movewindow, l
bind = $mod SHIFT, right, movewindow, r
bind = $mod SHIFT, up, movewindow, u
bind = $mod SHIFT, down, movewindow, d
bindm = $mod, mouse:272, movewindow

# Resize focused window
binde  = $mod ALT, H, resizeactive, -5% 0
binde  = $mod ALT, J, resizeactive, 0 -5%
binde  = $mod ALT, K, resizeactive, 0 5%
binde  = $mod ALT, L, resizeactive, 5% 0
binde  = $mod ALT, left, resizeactive, -5% 0
binde  = $mod ALT, right, resizeactive, 5% 0
binde  = $mod ALT, up, resizeactive, 0 5%
binde  = $mod ALT, down, resizeactive, 0 -5%
bindm = $mod, mouse:273, resizewindow

# Fullscreen
bind = $mod, M, fullscreen, 1
bind = $mod SHIFT, M, fullscreen, 0

bind = $mod, slash, exec, rofi -modi drun,run -show drun -show-icons
bind = $mod, Tab, exec, rofi -modi window -show window -show-icons -display-drun 'Windows' -show-icons
bind = $mod SHIFT, escape, exec, rofi -show power-menu:'$rofiscripts/rofi-power-menu.sh --choices=shutdown/reboot/lockscreen/logout' -theme-str 'window {width: 5%; height: 20%;}'
bind = $mod, c, exec, rofi -modi clipboard:$rofiscripts/rofi-clip.sh -show clipboard -show-icons -display-column 2
bind = $mod CTRL, c, exec, rofi -show calc -modi calc -no-show-match -no-sort
bind = $mod SHIFT, c, exec, hyprpicker --autocopy --format=hex --lowercase-hex
bind = $mod, p, exec, $rofiscripts/rofi-pass.fish
bind = $mod ALT, p, exec, $rofiscripts/rofi-pass.fish show-last
bind = $mod SHIFT, p, exec, $rofiscripts/rofi-pass.fish insert
bind = $mod, e, exec, rofimoji --keybinding-copy alt-c

# Switch workspaces with mod + [0-9]
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

# Move active window to a workspace with mod + SHIFT + [0-9]
bind = $mod SHIFT, 1, movetoworkspace, 1
bind = $mod SHIFT, 2, movetoworkspace, 2
bind = $mod SHIFT, 3, movetoworkspace, 3
bind = $mod SHIFT, 4, movetoworkspace, 4
bind = $mod SHIFT, 5, movetoworkspace, 5
bind = $mod SHIFT, 6, movetoworkspace, 6
bind = $mod SHIFT, 7, movetoworkspace, 7
bind = $mod SHIFT, 8, movetoworkspace, 8
bind = $mod SHIFT, 9, movetoworkspace, 9
bind = $mod SHIFT, 0, movetoworkspace, 10

# Scroll through existing workspaces with mod + scroll
bind = $mod, mouse_down, workspace, e+1
bind = $mod, mouse_up, workspace, e-1

# Layout
bind = $mod, V, togglesplit
bind = $mod, F, cyclenext, none, floating
bind = $mod SHIFT, F, focuscurrentorlast
bind = $mod ALT, F, togglefloating

# Media
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioStop, exec, playerctl stop
bindl = , XF86AudioPrev, exec, playerctl previous
bindl = , XF86AudioNext, exec, playerctl next
bindl = CTRL, XF86AudioPrev, exec, playerctld unshift
bindl = CTRL, XF86AudioNext, exec, playerctld shift
bindl = CTRL, XF86AudioPrev, exec, playerctld unshift
bindl = CTRL, XF86AudioNext, exec, playerctld shift
bindel = , XF86AudioRaiseVolume, exec, $scripts/media.fish volume sink up
bindel = , XF86AudioLowerVolume, exec, $scripts/media.fish volume sink down
bindel = , XF86AudioMute, exec, $scripts/media.fish volume sink mute
bindel = SHIFT, XF86AudioRaiseVolume, exec, $scripts/media.fish volume source up
bindel = SHIFT, XF86AudioLowerVolume, exec, $scripts/media.fish volume source down
bindel = SHIFT, XF86AudioMute, exec, $scripts/media.fish volume source mute
bindel = $mod, XF86AudioRaiseVolume, exec, $scripts/media.fish brightness up
bindel = $mod, XF86AudioLowerVolume, exec, $scripts/media.fish brightness down
bindel = $mod, XF86AudioMute, exec, $scripts/media.fish brightness reset
# bindel = , XF86MonBrightnessUp, exec, $scripts/media.fish brightness up
# bindel = , XF86MonBrightnessDown, exec, $scripts/media.fish brightness down
# bindsym Print exec flameshot gui
# bindsym Control+Print exec flameshot screen --clipboard --path $HOME/pictures/screenshots

# Misc
bind = $mod, escape, exec, hyprlock
bind = $mod, N, exec, wired --drop latest
bind = $mod SHIFT, N, exec, wired --drop all
bind = $mod, Q, killactive
bind = $hypr, escape, exit

# Apps
bind = $mod, O, submap, apps

submap = apps

bind = , T, exec, $terminal
bind = , T, submap, reset

bind = , B, exec, $browser
bind = , B, submap, reset

bind = SHIFT, B, exec, $browser --target private-window
bind = SHIFT, B, submap, reset

bind = , D, exec, vesktop
bind = , D, submap, reset

# TODO: spotify
#         bindsym S exec spotify; mode "default"

bind = , F, exec, $filemanager
bind = , F, submap, reset


bind = , catchall, submap, reset
submap = reset

bind = $mod, comma, submap, settings
submap = settings

bind = , b, exec, bzmenu -l rofi
bind = , b, submap, reset

bind = , s, exec, $rofiscripts/rofi-sound.fish
bind = , s, submap, reset

bind = , w, exec, iwmenu -l rofi
bind = , w, submap, reset

bind = , d, exec, $rofiscripts/rofi-systemd.sh
bind = , d, submap, reset

bind = , u, exec, $rofiscripts/rofi-usb.fish
bind = , u, submap, reset

bind = , catchall, submap, reset
submap = reset

# Windows & Workspaces

## Ignore maximize requests from apps. You'll probably like this.
windowrule = suppressevent maximize, class:.*

## Fix some dragging issues with XWayland
windowrule = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

## Gaming app
$games = class:^(cs2|steam|PEAK)$
windowrule = immediate, $games
windowrule = opacity 1 override 1 override, $games
windowrule = noblur, $games

## Make steam's friends list floating
windowrule = float, class:^(steam)$, title:^(Friends List)$

## Blur layers
layerrule = blur, rofi
layerrule = blur, waybar
layerrule = ignorezero, waybar

# ## Disable gaps and border for workspaces with one window
# workspace = w[tv1], gapsout:0, gapsin:0
# workspace = f[1], gapsout:0, gapsin:0
# windowrulev2 = bordersize 0, floating:0, onworkspace:w[tv1]
# windowrulev2 = rounding 0, floating:0, onworkspace:w[tv1]
# windowrulev2 = bordersize 0, floating:0, onworkspace:f[1]
# windowrulev2 = rounding 0, floating:0, onworkspace:f[1]
